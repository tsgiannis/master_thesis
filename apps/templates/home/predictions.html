{% extends "layouts/base.html" %}

{% block title %} Intelligent Classifier {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
<style>
        .data-table tbody tr td:not(:has(input[type="checkbox"])) {
            cursor: pointer;
            transition: transform 0.3s ease;  /* Add a smooth transition effect */
        }

        .data-table tbody tr td.active:not(:has(input[type="checkbox"])) {
            transform: scale(2);  /* Adjust the magnification factor as needed */
        }
        input.checkbox-cell  {
    /* Add any additional styles here */
    width: 25px; /* Adjust the width as needed */
    height: 25px;
    border-radius: 4px;
}
    </style>


{% endblock stylesheets %}

{% block content %}
 <button id="saveButton" class="btn btn-primary" onclick="saveToDatabase()">Save to Database</button>
<!-- Your Bootstrap table -->
<div class="container mt-5 data-table">
    <!-- Insert the generated HTML table here -->
    {{ table_html | safe }}
</div>
<!-- Modal structure -->
<!-- Modal structure -->
<div id="myModal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Cell Content</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body" id="modalContent"></div>
        </div>
    </div>
</div>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>
    // Plain JavaScript function to handle button click
// Plain JavaScript function to handle button click
function saveToDatabase() {
    // Collect data from the table
    var tableData = [];
    var rows = document.getElementById('codesTable').getElementsByTagName('tr');
    for (var i = 1; i < rows.length; i++) { // Start from index 1 to skip header row
        var code = rows[i].getElementsByTagName('td')[0].textContent;
        var isCorrect = rows[i].querySelector('.correctCheckbox').checked;
        var anotherValue = rows[i].querySelector('.anotherCheckbox').checked;
        tableData.push({ code: code, isCorrect: isCorrect, anotherValue: anotherValue });
    }

    // Send data to backend
    fetch('/save_to_database', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(tableData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Failed to save data to database');
        }
        console.log('Data saved successfully');
    })
    .catch(error => {
        console.error('Error:', error);
    });

    // Retrieve authenticated user information (if available)
    var authenticatedUser = localStorage.getItem('authenticatedUser');
    console.log('Authenticated user:', authenticatedUser);
}

   // Add click event to each cell using jQuery
    $(document).on('click', '.data-table tbody tr td', function() {
        // Your custom logic when a cell is clicked
        console.log('Clicked:', $(this).text());

        // Show modal with cell content
        showModal(this);
    });

    // Add mouseover and mouseout events to toggle the 'active' class
    $(document).on('mouseover', '.data-table tbody tr td', function() {
        $(this).addClass('active');
    });

    $(document).on('mouseout', '.data-table tbody tr td', function() {
        $(this).removeClass('active');
    });

    // Show modal function
    function showModal(cell) {
        var modalContent = $('#modalContent');
        modalContent.empty();  // Clear existing content

        // Add content to modal (you can customize this part)
        modalContent.text($(cell).text());

        // Show the modal using Bootstrap modal methods
        $('#myModal').modal('show');
    }
   function toggleCheckmark(checkbox, resultType) {
    var checkmark = checkbox.nextSibling;
    if (checkbox.checked) {
      checkmark.style.display = 'inline';
    } else {
      checkmark.style.display = 'none';
    }
}
</script>
{% endblock javascripts %}
